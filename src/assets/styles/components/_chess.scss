@import "../abstracts/variables";
@import "../abstracts/mixins";
@import "../themes/boards/defaultBoard";
@import "../themes/pieces/defaultPieces";

// Chess board container
.chess-board {
	display: grid;
	grid-template-columns: repeat(8, 1fr);
	grid-template-rows: repeat(8, 1fr);
	gap: 0;
	border: 2px solid $border-primary-color;
	border-radius: $border-radius-sm;
	overflow: hidden;
	max-width: 600px;
	aspect-ratio: 1;
	margin: 0 auto;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);

	// Support for different board sizes
	&.board-6x6 {
		grid-template-columns: repeat(6, 1fr);
		grid-template-rows: repeat(6, 1fr);
	}

	&.board-10x10 {
		grid-template-columns: repeat(10, 1fr);
		grid-template-rows: repeat(10, 1fr);
	}

	&.board-12x12 {
		grid-template-columns: repeat(12, 1fr);
		grid-template-rows: repeat(12, 1fr);
	}
}

// Individual square
.chess-square {
	@include flex-center;
	position: relative;
	aspect-ratio: 1;
	cursor: pointer;
	transition: all $transition-super-fast;

	// Alternating square colors
	&.light-square {
		background-color: $light-sqr-color;
	}

	&.dark-square {
		background-color: $dark-sqr-color;
	}

	// Square states
	&.highlighted {
		box-shadow: inset 0 0 0 3px $warning;
		z-index: 1;
	}

	&.selected {
		box-shadow: inset 0 0 0 3px $primary-color;
		background-color: rgba($primary-color, 0.2) !important;
		z-index: 2;
	}

	&.valid-move {
		&::after {
			content: "";
			width: 30%;
			height: 30%;
			background-color: rgba($success, 0.6);
			border-radius: 50%;
			position: absolute;
		}
	}

	&.attack-move {
		box-shadow: inset 0 0 0 3px $danger;

		&::after {
			content: "";
			position: absolute;
			top: 10%;
			left: 10%;
			right: 10%;
			bottom: 10%;
			border: 2px solid $danger;
			border-radius: 50%;
		}
	}

	&.last-move {
		box-shadow: inset 0 0 0 2px rgba($primary-color, 0.8);
		background-color: rgba($primary-color, 0.15) !important;
	}

	&:hover:not(.selected) {
		background-color: rgba($primary-color, 0.1) !important;
	}
}

// Chess piece
.chess-piece {
	font-size: 2.5rem;
	line-height: 1;
	user-select: none;
	transition: transform $transition-super-fast;
	cursor: grab;

	&:active {
		cursor: grabbing;
		transform: scale(1.1);
	}

	&.light-piece {
		color: $light-piece-color;
		text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
	}

	&.dark-piece {
		color: $dark-piece-color;
		text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
	}

	// Different piece sizes for different board sizes
	.board-6x6 & {
		font-size: 2rem;
	}

	.board-10x10 & {
		font-size: 2rem;
	}

	.board-12x12 & {
		font-size: 1.5rem;
	}
}

// Game panel for displaying game info
.game-panel {
	background-color: $background-alt;
	border: 1px solid $border-primary-color;
	border-radius: $border-radius-md;
	padding: $spacing-md;

	.panel-header {
		@include flex-between;
		align-items: center;
		margin-bottom: $spacing-md;
		padding-bottom: $spacing-sm;
		border-bottom: 1px solid $border-primary-color;

		h3 {
			margin: 0;
			color: $text-primary-color;
		}
	}

	.panel-content {
		color: $text-secondary-color;
	}
}

// Player info component
.player-info {
	@include flex-gap($spacing-md);
	align-items: center;
	padding: $spacing-md;
	background-color: $background-alt;
	border-radius: $border-radius-md;
	border: 1px solid $border-primary-color;

	&.active-player {
		border-color: $primary-color;
		box-shadow: 0 0 0 1px rgba($primary-color, 0.3);
	}

	.player-avatar {
		width: 3rem;
		height: 3rem;
		border-radius: 50%;
		background-color: $neutral-color;
		@include flex-center;
		color: white;
		font-weight: $font-weight-bold;
		font-size: $font-size-lg;
	}

	.player-details {
		flex: 1;

		.player-name {
			font-weight: $font-weight-medium;
			color: $text-primary-color;
			margin-bottom: $spacing-sm * 0.5;
		}

		.player-stats {
			font-size: $font-size-sm;
			color: $text-tertiary-color;
		}
	}

	.player-timer {
		font-family: $font-mono;
		font-size: $font-size-lg;
		font-weight: $font-weight-bold;
		color: $text-primary-color;

		&.timer-warning {
			color: $warning;
			animation: pulse 1s infinite;
		}

		&.timer-danger {
			color: $danger;
			animation: pulse 0.5s infinite;
		}
	}
}

// Move history
.move-history {
	max-height: 300px;
	overflow-y: auto;
	background-color: $background;
	border: 1px solid $border-primary-color;
	border-radius: $border-radius-sm;
	padding: $spacing-sm;

	.move-item {
		@include flex-between;
		padding: $spacing-sm;
		border-radius: $border-radius-sm;
		margin-bottom: $spacing-sm * 0.5;
		transition: background-color $transition-super-fast;

		&:hover {
			background-color: $background-alt;
		}

		&.current-move {
			background-color: rgba($primary-color, 0.1);
			border-left: 3px solid $primary-color;
		}

		.move-number {
			font-weight: $font-weight-bold;
			color: $text-tertiary-color;
			min-width: 2rem;
		}

		.move-notation {
			font-family: $font-mono;
			color: $text-primary-color;
		}

		.move-time {
			font-size: $font-size-sm;
			color: $text-tertiary-color;
		}
	}
}

// Game status indicator
.game-status {
	text-align: center;
	padding: $spacing-md;
	border-radius: $border-radius-md;
	font-weight: $font-weight-medium;

	&.status-playing {
		background-color: rgba($primary-color, 0.1);
		color: $primary-color;
		border: 1px solid rgba($primary-color, 0.3);
	}

	&.status-check {
		background-color: rgba($warning, 0.1);
		color: $warning;
		border: 1px solid rgba($warning, 0.3);
	}

	&.status-checkmate {
		background-color: rgba($danger, 0.1);
		color: $danger;
		border: 1px solid rgba($danger, 0.3);
	}

	&.status-stalemate {
		background-color: rgba($neutral-color, 0.1);
		color: $neutral-color;
		border: 1px solid rgba($neutral-color, 0.3);
	}

	&.status-draw {
		background-color: rgba($neutral-color, 0.1);
		color: $neutral-color;
		border: 1px solid rgba($neutral-color, 0.3);
	}
}

// Piece promotion dialog
.promotion-dialog {
	position: absolute;
	background-color: $background-alt;
	border: 1px solid $border-primary-color;
	border-radius: $border-radius-md;
	padding: $spacing-md;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
	z-index: 1000;

	.promotion-pieces {
		@include flex-gap($spacing-sm);

		.promotion-piece {
			@include flex-center;
			width: 3rem;
			height: 3rem;
			background-color: $background;
			border: 1px solid $border-primary-color;
			border-radius: $border-radius-sm;
			cursor: pointer;
			transition: all $transition-super-fast;

			&:hover {
				border-color: $primary-color;
				background-color: rgba($primary-color, 0.1);
				transform: scale(1.05);
			}

			.chess-piece {
				font-size: 1.5rem;
			}
		}
	}
}

// Animations
@keyframes pulse {
	0%,
	100% {
		opacity: 1;
	}
	50% {
		opacity: 0.5;
	}
}

@keyframes slideIn {
	from {
		transform: translateX(-100%);
		opacity: 0;
	}
	to {
		transform: translateX(0);
		opacity: 1;
	}
}

// Drag and drop states
.piece-dragging {
	opacity: 0.7;
	transform: rotate(5deg);
	z-index: 1000;
	pointer-events: none;
}

.drop-target {
	background-color: rgba($success, 0.2) !important;
	box-shadow: inset 0 0 0 2px $success;
}

.drop-invalid {
	background-color: rgba($danger, 0.2) !important;
	box-shadow: inset 0 0 0 2px $danger;
}
